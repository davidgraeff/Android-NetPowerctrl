apply plugin: 'com.android.application'

android {
    compileSdkVersion 27
    buildToolsVersion "26.0.2"

//    productFlavors {
//        //noinspection GroovyMissingReturnStatement
//        vanilla {
//
//        }
//    }

    def appID = "oly.netpowerctrl"

    defaultConfig {
        minSdkVersion 17
        targetSdkVersion 27
        versionCode 129
        versionName "9.0"
        applicationId appID
        testApplicationId "oly.netpowerctrl.tests"
        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
        resConfig "de"
    }

    lintOptions {
        abortOnError false
        warning "MissingTranslation"
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    def getRevision = { ->
        def stdout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'rev-parse', '--short', 'HEAD'
            standardOutput = stdout
        }
        return stdout.toString().trim()
    }

    buildTypes {
        release {
            zipAlignEnabled true
            minifyEnabled true
            resValue "string", "authority", appID + ".utils.AssetDocumentProvider"
            //buildConfigField "String", "AUTHORITY", appID + ".utils.AssetDocumentProvider"
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.txt'
            debuggable false
        }
        debug {
            versionNameSuffix "-" + getRevision()
            applicationIdSuffix ".debug"
            resValue "string", "authority", appID + ".utils.AssetDocumentProvider.Debug"
            //buildConfigField "String", "AUTHORITY", appID + ".utils.AssetDocumentProvider.Debug"
            zipAlignEnabled true
            proguardFiles 'proguard-rules-debug.txt'
            minifyEnabled true
        }
    }

    allprojects {
        tasks.withType(JavaCompile) {
            options.compilerArgs << "-Xlint:deprecation"
        }
    }

//    splits {
//        density {
//            enable true
//            //exclude "ldpi", "tvdpi", "xxxhdpi"
//            //compatibleScreens 'small', 'normal', 'large', 'xlarge'
//        }
//    }

    sourceSets {
        main {
            java.srcDirs = ['src/main/java', 'src/tests/java']
        }
    }

    aaptOptions {
        //noCompress 'txt'
        ignoreAssetsPattern "!.svn:!.git:!.ds_store:!*.scc:.*:<dir>_*:!CVS:!thumbs.db:!picasa.ini:!*~"
    }
}

dependencies {
    //compile fileTree(dir: 'libs', include: ['*.jar']) :5.2.08 5.0.89
    //compile 'com.google.android.gms:play-services:5.2.08'
    //noinspection GradleDependency
    compile 'com.android.support:appcompat-v7:27.0.0'
    compile 'com.android.support:support-v13:27.0.0'
    compile 'com.android.support:recyclerview-v7:27.0.0'
    compile 'com.android.support:palette-v7:27.0.0'
    compile 'com.android.support:cardview-v7:27.0.0'
    compile 'com.afollestad:material-cab:0.1.12',
    compile('com.github.rey5137:material:1.1.0') {
        exclude group: 'com.google.android'
        exclude group: 'com.android.support'
    }
    compile 'com.google.code.gson:gson:2.8.0'
    compile('com.wefika:flowlayout:0.3.4') {
        exclude group: 'com.google.android'
        exclude group: 'com.android.support'
    }
    compile('jp.wasabeef:recyclerview-animators:1.2.0@aar') {
        exclude group: 'com.google.android'
        exclude group: 'com.android.support'
    }
    compile('com.github.gabrielemariotti.changeloglib:library:1.5.2') {
        exclude group: 'com.google.android'; exclude group: 'com.android.support'
    }
    compile('ch.acra:acra:4.6.2') {
        exclude group: 'com.google.android'; exclude group: 'org.json';
        exclude group: 'com.android.support'
    }
    compile('net.lingala.zip4j:zip4j:1.3.2') {
        exclude group: 'com.google.android'
        exclude group: 'com.android.support'
    }
    compile('com.google.code.ndef-tools-for-android:ndeftools:1.2.4') {
        exclude group: 'com.google.android'
        exclude group: 'com.android.support'
    }
    compile('com.google.code.ndef-tools-for-android:ndeftools-util:1.2.4') {
        exclude group: 'com.google.android'
        exclude group: 'com.android.support'
    }

    // AndroidJUnitRunner and JUnit Rules
    androidTestCompile 'com.android.support.test:runner:1.0.1'
    androidTestCompile 'com.android.support.test:rules:1.0.1'
    androidTestCompile 'junit:junit:4.12'
    // Espresso dependencies
    androidTestCompile 'com.android.support.test.espresso:espresso-core:3.0.1'
    androidTestCompile 'com.android.support.test.espresso:espresso-contrib:3.0.1'
    androidTestCompile 'com.android.support.test.espresso:espresso-intents:3.0.1'
    androidTestCompile 'com.android.support.test.espresso:espresso-accessibility:3.0.1'
    androidTestCompile 'com.android.support.test.espresso:espresso-web:3.0.1'
    androidTestCompile 'com.android.support.test.espresso.idling:idling-concurrent:3.0.1'

    // The following Espresso dependency can be either "compile"
    // or "androidTestCompile", depending on your app's implementation
    androidTestCompile 'com.android.support.test.espresso:espresso-idling-resource:3.0.1'
    androidTestUtil 'com.android.support.test:orchestrator:1.0.1'
}